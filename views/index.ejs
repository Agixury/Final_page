<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('partials/head.ejs') %>
    <link rel="stylesheet" href="stylesheets/styles.css">
</head>

<body data-spy="scroll" data-target=".navbar" data-offset="50">

    <%- include('partials/header-navbar.ejs') %>

    <!-- HEADER BEGINS HERE -->
    <div class="head_cont container-fluid">
        <div class="row row-header-empty"></div>

        <div class="container" id="social-button-last">

            <div class="row">
                <div class="col d-flex justify-content-end">
                    <a class="btn btn-social-icon btn-facebook"
                        href="https://m.facebook.com/Agixury-105143354685132/?tsid=0.7678211859768536&source=result"><img
                            src="images/facebook.svg"></a>
                </div>

            </div>
            <div class="row">
                <div class="col d-flex justify-content-end">
                    <a class="btn btn-social-icon btn-linkedin" href="http://instagram.com/agixury"><img src="images/instagram.svg"></i></a>
                </div>

            </div>
            <div class="row">
                <div class="col d-flex justify-content-end">
                    <a class="btn btn-social-icon btn-linkedin" href="https://www.linkedin.com/company/agixury"><img src="images/linkedin.svg"></a>
                </div>

            </div>

        </div>


        <!--icon set and sub-->
        <div class="row" id="header-to-go">
            <div class="col-6">
                <div class="row">
                    <div class="container">

                        <div class="row">
                            <div class="col-10">
                                <a class="btn btn-social-icon btn-facebook" href="http://www.facebook.com/profile.php?id="><img
                                        src="images/facebook.svg"></a>
                            </div>
                            <div class="col"></div>
                        </div>
                        <div class="row">
                            <div class="col-10">
                                <a class="btn btn-social-icon btn-linkedin" href="http://www.linkedin.com/in/"><img
                                        src="images/instagram.svg"></i></a>
                            </div>
                            <div class="col"></div>
                        </div>
                        <div class="row">
                            <div class="col-10">
                                <a class="btn btn-social-icon btn-linkedin" href="http://www.linkedin.com/in/"><img src="images/linkedin.svg"></a>
                            </div>
                            <div class="col"></div>
                        </div>

                    </div>
                </div>
                <div class="row row-subscribe"
                    style=" width: 3000px;height: 80px; margin-top: 9%; position:fixed;z-index: 1; bottom:0;margin-bottom:9.5rem;">
                    <!--sub-->

                    <div class="col-12" style="position: absolute;z-index: 1;"></div>
                    <div class="offset-4 col-8" style="background: #0000007C; opacity: 1; margin-left : 0px;padding-bottom: 1%;">
                        <div style="float: left; color: #ffffff; margin-left:5%;margin-top:2%;font-size: 12px;padding-top: 2%;">
                            <h3>Never miss a deal</h3>
                            <p>Get the best travel deals in you inbox</p>
                        </div>
                        <div class="Subscribe" style="float: right;margin-right: 54%; padding-top: 2%;position:absoluete;z-index: 5;">
                            <p>Subscribe to our Newsletter</p>
                            <form action="#" style="width:450px;">
                                <input type="text" placeholder="Please enter your Email" style="background: #000000; ">
                                <input type="submit" value="SUBSCRIBE">
                                <label style=" margin-left:5px;color: #ffffff;text-align: left;"><input type="checkbox" name="t&c">i agree to the <a
                                        href="#">Terms & conditions</a>and to subscribe to offers,alerts and services. </label>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6" id="authFormContainer">
                <div class="row row-login">
                    <div class="login-signup" style=" z-index: 2;">
                        <div class="inner">

                            <div class="option">
                                <button class="line" id="loginbtn"><a href="#">Log In</a></button>
                                <button class="signupbtn"><a href="#">Sign up</a></button>
                            </div>
                            <div class="loginform">
                                <form id="loginForm">
                                    <input id="emailOrContact" type="text" placeholder="Email or phone">
                                    <input id="passwordLogin" type="password" placeholder="Password">
                                    <input type="submit" value="Log In">
                                </form>
                                <a href="#">forgotten password?</a>

                                <div class="botm-option">
                                    <button class="line"><a href="#">Log In with <i class="fa fa-facebook" aria-hidden="true"></i></a></button>
                                    <button><a href="#">Log In with&nbsp;<i class="fa fa-envelope mail" aria-hidden="true"></i></a></button>
                                </div>

                            </div>
                            <div class="signupform" style="margin-bottom:8px; padding-top :0.5px ;">
                                <form id="registerForm">
                                    <input id="firstName" type="text" placeholder="First name" style="margin-top: 0.5rem; height:2.5rem;">
                                    <input id="lastName" type="text" placeholder="Last name" style="margin-top: 0.5rem; height:2.5rem;">
                                    <input id="email" type="email" placeholder="Enter email" style="width: 90%;
                                    margin-top: 20px;
                                    padding: 10px;
                                    color:white;
                                    border: none;
                                    outline: none;
                                    background-color: rgba(1, 1, 1, 0.2);
                                    margin-top: 0.5rem; height:2.5rem;
                                    font-size: 18px;
                                    box-shadow: 0px 0px 3px -1px rgba(255, 255, 255, 1);">
                                    <input id="contactNumber" type="text" placeholder="Contact number" style="margin-top: 0.5rem; height:2.5rem;">
                                    <input id="password" type="password" placeholder="Password" style="margin-top: 0.5rem; height:2.5rem;">
                                    <input id="repeatPassword" type="password" placeholder="confirm password"
                                        style="margin-top: 0.5rem; height:2.5rem;">
                                    <input type="submit" value="Sign up">
                                </form>
                            </div>


                        </div>
                    </div>
                </div>
                <!--forms-->
            </div>
        </div>

    </div>
    <!--End of HEADER-->


    <!--list-->
    <div class="container" style="z-index: 0;">
        <div class="row"
            style=" border: 1px solid grey; box-shadow: 1px 1px #dcdcdc; display: flex; flex-wrap:wrap; text-align: left; margin:1.5rem; width:85%">
            <div class="col-12 col-sm-3" style="padding:0px;">
                <img src="images/p.jpg" alt="" style="margin: 0px; width: 100%;height:100%;position:absolute;z-index: 0;  " /></div>
            <div class="col-12 col-sm" style="text-align:left; align-content: space-around;">
                <span class="tagname" style="padding: 0.01rem;text-align: left;">
                    <h2>Jaipur</h2>
                </span><br>
                <span class="content" style="margin-top: 0rem;">
                    <p> Jaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best
                        place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place
                        tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisit</p>
                </span>
                <span class="buttons">
                    <button style="border-radius: 10% ; width: 15%; margin: 0.5%">4.2 <i class="fas fa-star"></i></button> &nbsp; &nbsp; &nbsp; &nbsp;
                    &nbsp;<button style="border-radius: 25% ; width: 15%; margin: 0.5%">5 days</button> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<button
                        style="border-radius: 25% ; width: 17%; margin: 0.5%">available</button>
                </span>
            </div>
        </div>
        <div class="row"
            style="border: 1px solid grey; box-shadow: 1px 1px #dcdcdc; display: flex; flex-wrap:wrap; text-align: left; margin:1.5rem; width:85%">
            <div class="col-12 col-sm-3" style="padding:0px;">
                <img src="images/p.jpg" alt="" style="margin: 0px; width: 100%;height:100%;z-index:-1;position:absoluete; " /></div>
            <div class="col-12 col-sm" style="text-align:left; align-content: space-around;">
                <span class="tagname" style="padding: 0.01rem;text-align: left;">
                    <h2>Jaipur</h2>
                </span><br>
                <span class="content" style="margin-top: 0rem;">
                    <p> Jaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best
                        place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place
                        tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisit</p>
                </span>
                <span class="buttons">
                    <button style="border-radius: 10% ; width: 15%; margin: 0.5%">4.2 <i class="fas fa-star"></i></button> &nbsp; &nbsp; &nbsp; &nbsp;
                    &nbsp;<button style="border-radius: 25% ; width: 15%; margin: 0.5%">5 days</button> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<button
                        style="border-radius: 25% ; width: 17%; margin: 0.5%">available</button>
                </span>
            </div>
        </div>
        <div class="row"
            style="border: 1px solid grey; box-shadow: 1px 1px #dcdcdc; display: flex; flex-wrap:wrap; text-align: left; margin:1.5rem; width:85%">
            <div class="col-12 col-sm-3" style="padding:0px;">
                <img src="images/p.jpg" alt="" style="margin: 0px; width: 100%;height:100%;z-index:-1;position:absoluete; " /></div>
            <div class="col-12 col-sm" style="text-align:left; align-content: space-around;">
                <span class="tagname" style="padding: 0.01rem;text-align: left;">
                    <h2>Jaipur</h2>
                </span><br>
                <span class="content" style="margin-top: 0rem;">
                    <p> Jaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best
                        place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place
                        tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisit</p>
                </span>
                <span class="buttons">
                    <button style="border-radius: 10% ; width: 15%; margin: 0.5%">4.2 <i class="fas fa-star"></i></button> &nbsp; &nbsp; &nbsp; &nbsp;
                    &nbsp;<button style="border-radius: 25% ; width: 15%; margin: 0.5%">5 days</button> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<button
                        style="border-radius: 25% ; width: 17%; margin: 0.5%">available</button>
                </span>
            </div>
        </div>
        <div class="row"
            style="border: 1px solid grey; box-shadow: 1px 1px #dcdcdc; display: flex; flex-wrap:wrap; text-align: left; margin:1.5rem; width:85%">
            <div class="col-12 col-sm-3" style="padding:0px;">
                <img src="images/p.jpg" alt="" style="margin: 0px; width: 100%;height:100%;z-index:-1;position:absoluete; " /></div>
            <div class="col-12 col-sm" style="text-align:left; align-content: space-around;">
                <span class="tagname" style="padding: 0.01rem;text-align: left;">
                    <h2>Jaipur</h2>
                </span><br>
                <span class="content" style="margin-top: 0rem;">
                    <p> Jaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best
                        place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place
                        tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisit</p>
                </span>
                <span class="buttons">
                    <button style="border-radius: 10% ; width: 15%; margin: 0.5%">4.2 <i class="fas fa-star"></i></button> &nbsp; &nbsp; &nbsp; &nbsp;
                    &nbsp;<button style="border-radius: 25% ; width: 15%; margin: 0.5%">5 days</button> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<button
                        style="border-radius: 25% ; width: 17%; margin: 0.5%">available</button>
                </span>
            </div>
        </div>
        <div class="row"
            style="border: 1px solid grey; box-shadow: 1px 1px #dcdcdc; display: flex; flex-wrap:wrap; text-align: left; margin:1.5rem; width:85%">
            <div class="col-12 col-sm-3" style="padding:0px;">
                <img src="images/p.jpg" alt="" style="margin: 0px; width: 100%;height:100%;z-index:-1;position:absoluete; " /></div>
            <div class="col-12 col-sm" style="text-align:left; align-content: space-around;">
                <span class="tagname" style="padding: 0.01rem;text-align: left;">
                    <h2>Jaipur</h2>
                </span><br>
                <span class="content" style="margin-top: 0rem;">
                    <p> Jaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best
                        place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place
                        tovisitJaipur is best place tovisitJaipur is best place tovisitJaipur is best place tovisit</p>
                </span>
                <span class="buttons">
                    <button style="border-radius: 10% ; width: 15%; margin: 0.5%">4.2 <i class="fas fa-star"></i></button> &nbsp; &nbsp; &nbsp; &nbsp;
                    &nbsp;<button style="border-radius: 25% ; width: 15%; margin: 0.5%">5 days</button> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<button
                        style="border-radius: 25% ; width: 17%; margin: 0.5%">available</button>
                </span>
            </div>
        </div>
    </div>
    <!--list completed-->

    <%- include('partials/footer.ejs') %>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script type="application/javascript">
        const loginForm = document.getElementById("loginForm");
        const registerForm = document.getElementById("registerForm");
        const authFormContainer = document.getElementById("authFormContainer");

        const loginHandler = async (event) => {
            event.preventDefault()

            const emailOrContact = document.getElementById("emailOrContact");
            const passwordLogin = document.getElementById("passwordLogin");

            console.log('[DEBUG] emailOrContact: ', emailOrContact.value)
            console.log('[DEBUG] typeof(emailOrContact): ', typeof (emailOrContact.value))

            let email;
            let contactNumber
            let password = passwordLogin.value

            if (parseInt(emailOrContact.value)) {
                contactNumber = emailOrContact.value
            } else {
                email = emailOrContact.value
            }

            const body = email ? { email, password } : { contactNumber, password }
            const url = "http://localhost:3000/users/login"

            // error handling needs some work
            axios.post(url, body).then(resp => {
                console.log('[DEBUG] resp: ', resp)
                console.log('[DEBUG] resp.data: ', resp.data)

                localStorage.setItem('user', JSON.stringify(resp.data.user))
                localStorage.setItem('token', resp.data.token)
                alert('Logged in successfully')
                authFormContainer.style.display = 'none'
            }).catch(err => {
                console.log(err.response)
                alert('Wrong credentials.')
            })
        }

        const registerHandler = async (event) => {
            event.preventDefault()
            const firstName = document.getElementById("firstName").value;
            const lastName = document.getElementById("lastName").value;
            const email = document.getElementById("email").value;
            const contactNumber = document.getElementById("contactNumber").value;
            const password = document.getElementById("password").value;
            const repeatPassword = document.getElementById("repeatPassword").value;

            const body = {
                firstName,
                lastName,
                email,
                contactNumber,
                password,
                repeatPassword
            }

            const url = "http://localhost:3000/users/register"

            const resp = await axios.post(url, body)
            console.log('[DEBUG] resp: ', resp)

            // error handling needs some work
            axios.post(url, body).then(resp => {
                console.log('[DEBUG] resp: ', resp)
                console.log('[DEBUG] resp.data: ', resp.data)

                localStorage.setItem('user', JSON.stringify(resp.data.user))
                localStorage.setItem('token', resp.data.token)
                alert('Registered successfully')

                authFormContainer.style.display = 'none'
            }).catch(err => {
                console.log(err.response)
                alert('Invalid credentials.')
            })
        }

        loginForm.addEventListener("submit", loginHandler);
        registerForm.addEventListener("submit", registerHandler);

    </script>
</body>
<script>
    $(document).ready(function () {

        $(".signupform").hide();

        $(".signupbtn").click(function () {
            $(".signupform").show();
            $(".loginform").hide();
        });

        $("#loginbtn").click(function () {
            $(".signupform").hide();
            $(".loginform").show();
        })
    });

</script>

</html>